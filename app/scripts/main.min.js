/*
 *
 *  Air Horner
 *  Copyright 2015 Google Inc. All rights reserved.
 *
 *  Licensed under the Apache License, Version 2.0 (the 'License');
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *      https://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an 'AS IS' BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License
 *
 */
(function ($) {
	'use strict';

	var language = 'en-US';
	var voice = 'ann';
	var sound = null;

	var change_sound = function (language) {
		sound = new Howl({
			urls: ['sounds/' + language + '/' + voice + '/alphabet.mp3'],
			sprite: soundsConfig.language[language].voice[voice].sprite
		});
	};

	var set_language = function (lang) {
		language = lang;
		$('body').removeClass();
		$('body').addClass(language.toLowerCase());

		change_sound(language);
	};

	var set_voice = function (person) {
		voice = person;
		change_sound(language);
	};

	var abc = (function () {
		var output = [];
		for (var i = 'A'.charCodeAt(0); i <= 'Z'.charCodeAt(0); i++)
			output.push(String.fromCharCode(i));
		return output;
	})();

	var numbers = (function () {
		var output = [];
		for (var i = '1'; i <= '9'; i++)
			output.push(String(i));
		output.push(String(0));
		return output;
	})();

	var add_button = function (val) {
		var html = '<span class="character ' + val + '">' + val + '</span>';
		$('#characters').append(html).find('.character.' + val).touchstart(function (i) {
			button_clicked(this.innerHTML);
		});
	};

	var button_clicked = function (character) {
		sound.play(character.toLowerCase());
	};

	var init = function () {
		$(document).ready(function () {
			$.each(abc, function (i, val) {
				add_button(val);
			});

			set_language('pt-BR');

			$('.setting-button').click(function () {
				$('#characters').hide();
				$('#settings').show();
			});

			$('.close-settings-button').click(function () {
				$('#characters').show();
				$('#settings').hide();
			});

			$('input:radio').change(
				function () {
					switch (this.name) {
						case 'language':
							set_language(this.value);
							break;
						case 'voice':
							set_voice(this.value);
							break;
					}
				}
			);
		});
	};

	init();

})(jQuery);
