/*
 *  Alphabet
 */

function Main() {
  var mediaMapJson = {};
  var alphabetJson = {};

  this.language = '';
  this.person = '';
  this.alphabetSound = {};

  // Load media config.
  $.ajax({
    url: './mediamap.json',
    async: false,
    dataType: 'json',
    success: function (json) {
      mediaMapJson = json;
    }
  });
  this.mediaMapJson = mediaMapJson;
  mediaMapJson = {};

  // Load alphabet config.
  $.ajax({
    url: './sounds/alphabet.json',
    async: false,
    dataType: 'json',
    success: function (json) {
      alphabetJson = json;
    }
  });
  this.alphabetJson = alphabetJson;
  alphabetJson = {};
}

Main.prototype.setPerson = function(person) {
    this.person = person;

    this.changeSound();
};

Main.prototype.setLanguage = function(language) {
    this.language = language;
    $('body').removeClass();
    $('body').addClass(this.language.toLowerCase());

    this.changeSound();
};

Main.prototype.changeSound = function() {
  if (this.language == '')
    return;

  if (this.person == '')
    return;
  
  if (typeof this.alphabetJson.language[this.language].voice[this.person] == 'object') {
      var sprite = this.alphabetJson.language[this.language].voice[this.person].sprite;
      this.alphabetSound = new Howl({
        urls: ['./sounds/' + this.language + '/' + this.person + '/alphabet.mp3'],
        sprite: sprite,
        autoplay: false,
        loop: false,
        onend: function () {},
        onloaderror: function () {
          console.log('Not found ' + sprite)
        }
      });
    }
    else {
      console.log('Disable option ' + this.language + ' ' + this.person);
    }
};
